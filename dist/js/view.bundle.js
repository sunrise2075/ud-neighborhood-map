function initMap(){map=new google.maps.Map(document.getElementById("map-canvas"),{zoom:INIT_ZOOM_NUM,center:center.location}),map.setOptions({styles:styles});var e=[];geoLocations.forEach(function(o){var t=new google.maps.Marker({position:o.location,map:map,title:o.title,icon:{url:o.icon}});t.addListener("click",function(){t.setAnimation(4),openInfoWindow(t)}),e.push(t)}),initKoViewModel4App(e)}function openInfoWindow(e){infoWindow?infoWindow.marker=e:(infoWindow=new google.maps.InfoWindow({position:e.getPosition(),maxWidth:350}),infoWindow.addListener("closeclick",function(){infoWindow.marker=null})),infoWindow.setContent(""),infoWindow.marker=e,showLocationDetail(e),infoWindow.open(map,e)}function showLocationDetail(e){var o="https://maps.googleapis.com/maps/api/geocode/json?latlng="+e.position.lat()+","+e.position.lng()+"&key="+MY_API_KEY;$.ajax({url:o}).done(function(e,o,t){console.log(e);var n="";if("OK"===e.status){var i=e.results[0].place_id;n+="<div>地址ID:"+i+"</div>";var a=e.results[0].formatted_address;n+="<div>详情:"+a+"</div>";var s=e.results[0].geometry;n+="<div>类型:"+s.location_type+"</div>",n+="<div>纬度:"+s.location.lat+"</div>",n+="<div>经度:"+s.location.lng+"</div>",infoWindow.setContent(n)}}).fail(function(e,o,t){console.log("textStatus:"+o+", errorThrown:"+t)}).always(function(e,o,t){console.log("ajax request to foursquare is completed, textStatus:"+o)})}function loadCoffeeShopInfo(e){coffeeShopMarkers.forEach(function(e){e.setMap(null)}),coffeeShopMarkers.length=0;var o="XBEVRWM1JGYOB2WS5LMPM35BJZFAANOTAPEEGNNHQ52BDOXV",t="P1XBXTSAGOKAWMGYIMHOALG1NSBPOJYVZLUAD5RSQEGJ3MN5",n="https://api.foursquare.com/v2/venues/explore?",i="ll="+e.position.lat()+"%2C"+e.position.lng()+"&section=coffee&limit=10&novelty=new",a="&client_id="+o+"&client_secret="+t+"&v=20170308",s=n+i+a;$.ajax({url:s}).done(function(e,o,t){var n=e.response.groups[0].items;for(var i in n){var a=n[i].venue,s=new google.maps.Marker({position:new google.maps.LatLng(a.location.lat,a.location.lng),map:map,title:a.name,icon:{url:"./dist/images/coffee-n-tea.png"}});coffeeShopMarkers.push(s)}}).fail(function(e,o,t){console.log("textStatus:"+o+", errorThrown:"+t)}).always(function(e,o,t){console.log("ajax request to foursquare is completed, textStatus:"+o)})}function zoomIn2Marker(e){map.setCenter(e.getPosition()),map.setZoom(DETAIL_ZOOM_NUM)}function zoomOut2InitStatus(){map.setCenter(center.location),map.setZoom(INIT_ZOOM_NUM)}var styles=[{featureType:"water",stylers:[{color:"#19a0d8"}]},{featureType:"administrative",elementType:"labels.text.stroke",stylers:[{color:"#ffffff"},{weight:6}]},{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#e85113"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#efe9e4"},{lightness:-40}]},{featureType:"transit.station",stylers:[{weight:9},{hue:"#e85113"}]},{featureType:"road.highway",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{lightness:100}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{lightness:-100}]},{featureType:"poi",elementType:"geometry",stylers:[{visibility:"on"},{color:"#f0e4d3"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#efe9e4"},{lightness:-25}]}],map=null,MY_API_KEY="AIzaSyAyWxuLDi5aIxMGqATA74uLx4huY1uF4hg",infoWindow=null,INIT_ZOOM_NUM=11,DETAIL_ZOOM_NUM=14,coffeeShopMarkers=[];
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1hcC52aWV3LmpzIl0sIm5hbWVzIjpbImluaXRNYXAiLCJtYXAiLCJnb29nbGUiLCJtYXBzIiwiTWFwIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInpvb20iLCJJTklUX1pPT01fTlVNIiwiY2VudGVyIiwibG9jYXRpb24iLCJzZXRPcHRpb25zIiwic3R5bGVzIiwibWFya2VycyIsImdlb0xvY2F0aW9ucyIsImZvckVhY2giLCJsb2MiLCJtYXJrZXIiLCJNYXJrZXIiLCJwb3NpdGlvbiIsInRpdGxlIiwiaWNvbiIsInVybCIsImFkZExpc3RlbmVyIiwic2V0QW5pbWF0aW9uIiwib3BlbkluZm9XaW5kb3ciLCJwdXNoIiwiaW5pdEtvVmlld01vZGVsNEFwcCIsImluZm9XaW5kb3ciLCJJbmZvV2luZG93IiwiZ2V0UG9zaXRpb24iLCJtYXhXaWR0aCIsInNldENvbnRlbnQiLCJzaG93TG9jYXRpb25EZXRhaWwiLCJvcGVuIiwibGF0IiwibG5nIiwiTVlfQVBJX0tFWSIsIiQiLCJhamF4IiwiZG9uZSIsImRhdGEiLCJ0ZXh0U3RhdHVzIiwianFYaHIiLCJjb25zb2xlIiwibG9nIiwiZGV0YWlsU3RyaW5nIiwic3RhdHVzIiwicGxhY2VfaWQiLCJyZXN1bHRzIiwiZm9ybWF0dGVkX2FkZHJlc3MiLCJnZW9tZXRyeSIsImxvY2F0aW9uX3R5cGUiLCJmYWlsIiwiZXJyb3JUaHJvd24iLCJhbHdheXMiLCJqcVhIUk9yRGF0YSIsImpxWEhST3JFcnJvclRocm93biIsImxvYWRDb2ZmZWVTaG9wSW5mbyIsImNvZmZlZVNob3BNYXJrZXJzIiwiY29mZmVlQmFyTWFya2VyIiwic2V0TWFwIiwibGVuZ3RoIiwiY2xpZW50SWQiLCJjbGllbnRTZWNyZXQiLCJiYXNlVXJsIiwicXVlcnlQYXJhbXMiLCJ1c2VySW5mbyIsIml0ZW1zIiwicmVzcG9uc2UiLCJncm91cHMiLCJpIiwidmVudWUiLCJMYXRMbmciLCJuYW1lIiwiem9vbUluMk1hcmtlciIsInNldENlbnRlciIsInNldFpvb20iLCJERVRBSUxfWk9PTV9OVU0iLCJ6b29tT3V0MkluaXRTdGF0dXMiLCJmZWF0dXJlVHlwZSIsInN0eWxlcnMiLCJjb2xvciIsImVsZW1lbnRUeXBlIiwid2VpZ2h0IiwibGlnaHRuZXNzIiwiaHVlIiwidmlzaWJpbGl0eSJdLCJtYXBwaW5ncyI6IkFBbUZBLFFBQUFBLFdBQ0FDLElBQUEsR0FBQUMsUUFBQUMsS0FBQUMsSUFBQUMsU0FBQUMsZUFBQSxlQUNBQyxLQUFBQyxjQUNBQyxPQUFBQSxPQUFBQyxXQUVBVCxJQUFBVSxZQUFBQyxPQUFBQSxRQUdBLElBQUFDLEtBQ0FDLGNBQUFDLFFBQUEsU0FBQUMsR0FDQSxHQUFBQyxHQUFBLEdBQUFmLFFBQUFDLEtBQUFlLFFBQ0FDLFNBQUFILEVBQUFOLFNBQ0FULElBQUFBLElBQ0FtQixNQUFBSixFQUFBSSxNQUNBQyxNQUNBQyxJQUFBTixFQUFBSyxPQUdBSixHQUFBTSxZQUFBLFFBQUEsV0FFQU4sRUFBQU8sYUFBQSxHQUNBQyxlQUFBUixLQUVBSixFQUFBYSxLQUFBVCxLQUlBVSxvQkFBQWQsR0FTQSxRQUFBWSxnQkFBQVIsR0FLQVcsV0FTQUEsV0FBQVgsT0FBQUEsR0FSQVcsV0FBQSxHQUFBMUIsUUFBQUMsS0FBQTBCLFlBQ0FWLFNBQUFGLEVBQUFhLGNBQ0FDLFNBQUEsTUFFQUgsV0FBQUwsWUFBQSxhQUFBLFdBQ0FLLFdBQUFYLE9BQUEsUUFNQVcsV0FBQUksV0FBQSxJQUNBSixXQUFBWCxPQUFBQSxFQUNBZ0IsbUJBQUFoQixHQUNBVyxXQUFBTSxLQUFBakMsSUFBQWdCLEdBWUEsUUFBQWdCLG9CQUFBaEIsR0FFQSxHQUFBSyxHQUFBLDREQUNBTCxFQUFBRSxTQUFBZ0IsTUFDQSxJQUNBbEIsRUFBQUUsU0FBQWlCLE1BQ0EsUUFDQUMsVUFHQUMsR0FBQUMsTUFDQWpCLElBQUFBLElBRUFrQixLQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBQ0FDLFFBQUFDLElBQUFKLEVBQ0EsSUFBQUssR0FBQSxFQUNBLElBQUEsT0FBQUwsRUFBQU0sT0FBQSxDQUNBLEdBQUFDLEdBQUFQLEVBQUFRLFFBQUEsR0FBQUQsUUFDQUYsSUFBQSxhQUFBRSxFQUFBLFFBRUEsSUFBQUUsR0FBQVQsRUFBQVEsUUFBQSxHQUFBQyxpQkFDQUosSUFBQSxXQUFBSSxFQUFBLFFBRUEsSUFBQUMsR0FBQVYsRUFBQVEsUUFBQSxHQUFBRSxRQUNBTCxJQUFBLFdBQUFLLEVBQUFDLGNBQUEsU0FDQU4sR0FBQSxXQUFBSyxFQUFBekMsU0FBQXlCLElBQUEsU0FDQVcsR0FBQSxXQUFBSyxFQUFBekMsU0FBQTBCLElBQUEsU0FDQVIsV0FBQUksV0FBQWMsTUFHQU8sS0FBQSxTQUFBVixFQUFBRCxFQUFBWSxHQUNBVixRQUFBQyxJQUFBLGNBQUFILEVBQUEsaUJBQUFZLEtBRUFDLE9BQUEsU0FBQUMsRUFBQWQsRUFBQWUsR0FDQWIsUUFBQUMsSUFBQSx1REFBQUgsS0FjQSxRQUFBZ0Isb0JBQUF6QyxHQUVBMEMsa0JBQUE1QyxRQUFBLFNBQUE2QyxHQUNBQSxFQUFBQyxPQUFBLFFBR0FGLGtCQUFBRyxPQUFBLENBTUEsSUFBQUMsR0FBQSxtREFDQUMsRUFBQSxtREFLQUMsRUFBQSxnREFDQUMsRUFBQSxNQUFBakQsRUFBQUUsU0FBQWdCLE1BQUEsTUFBQWxCLEVBQUFFLFNBQUFpQixNQUFBLHVDQUNBK0IsRUFBQSxjQUFBSixFQUFBLGtCQUFBQyxFQUFBLGNBQ0ExQyxFQUFBMkMsRUFBQUMsRUFBQUMsQ0FHQTdCLEdBQUFDLE1BQ0FqQixJQUFBQSxJQUVBa0IsS0FBQSxTQUFBQyxFQUFBQyxFQUFBQyxHQUNBLEdBQUF5QixHQUFBM0IsRUFBQTRCLFNBQUFDLE9BQUEsR0FBQUYsS0FDQSxLQUFBLEdBQUFHLEtBQUFILEdBQUEsQ0FDQSxHQUFBSSxHQUFBSixFQUFBRyxHQUFBQyxNQUVBdkQsRUFBQSxHQUFBZixRQUFBQyxLQUFBZSxRQUNBQyxTQUFBLEdBQUFqQixRQUFBQyxLQUFBc0UsT0FBQUQsRUFBQTlELFNBQUF5QixJQUFBcUMsRUFBQTlELFNBQUEwQixLQUNBbkMsSUFBQUEsSUFDQW1CLE1BQUFvRCxFQUFBRSxLQUNBckQsTUFDQUMsSUFBQSxtQ0FHQXFDLG1CQUFBakMsS0FBQVQsTUFHQW9DLEtBQUEsU0FBQVYsRUFBQUQsRUFBQVksR0FDQVYsUUFBQUMsSUFBQSxjQUFBSCxFQUFBLGlCQUFBWSxLQUVBQyxPQUFBLFNBQUFDLEVBQUFkLEVBQUFlLEdBQ0FiLFFBQUFDLElBQUEsdURBQUFILEtBU0EsUUFBQWlDLGVBQUExRCxHQUNBaEIsSUFBQTJFLFVBQUEzRCxFQUFBYSxlQUNBN0IsSUFBQTRFLFFBQUFDLGlCQVFBLFFBQUFDLHNCQUNBOUUsSUFBQTJFLFVBQUFuRSxPQUFBQyxVQUNBVCxJQUFBNEUsUUFBQXJFLGVBdlFBLEdBQUFJLFVBRUFvRSxZQUFBLFFBQ0FDLFVBQ0FDLE1BQUEsY0FHQUYsWUFBQSxpQkFDQUcsWUFBQSxxQkFDQUYsVUFDQUMsTUFBQSxZQUNBRSxPQUFBLE1BR0FKLFlBQUEsaUJBQ0FHLFlBQUEsbUJBQ0FGLFVBQ0FDLE1BQUEsY0FHQUYsWUFBQSxlQUNBRyxZQUFBLGtCQUNBRixVQUNBQyxNQUFBLFlBQ0FHLFdBQUEsT0FHQUwsWUFBQSxrQkFDQUMsVUFDQUcsT0FBQSxJQUNBRSxJQUFBLGNBR0FOLFlBQUEsZUFDQUcsWUFBQSxjQUNBRixVQUNBTSxXQUFBLFVBR0FQLFlBQUEsUUFDQUcsWUFBQSxxQkFDQUYsVUFDQUksVUFBQSxRQUdBTCxZQUFBLFFBQ0FHLFlBQUEsbUJBQ0FGLFVBQ0FJLFdBQUEsUUFHQUwsWUFBQSxNQUNBRyxZQUFBLFdBQ0FGLFVBQ0FNLFdBQUEsT0FDQUwsTUFBQSxjQUdBRixZQUFBLGVBQ0FHLFlBQUEsZ0JBQ0FGLFVBQ0FDLE1BQUEsWUFDQUcsV0FBQSxPQU1BcEYsSUFBQSxLQUVBb0MsV0FBQSwwQ0FHQVQsV0FBQSxLQUVBcEIsY0FBQSxHQUNBc0UsZ0JBQUEsR0ErR0FuQiIsImZpbGUiOiJ2aWV3LmJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IHN1bnJpc2UyMDc1IG9uIDIwMTcvMi8yNi5cclxuICovXHJcbi8vIENyZWF0ZSBhIHN0eWxlcyBhcnJheSB0byB1c2Ugd2l0aCB0aGUgbWFwLlxyXG52YXIgc3R5bGVzID0gW1xyXG4gICAge1xyXG4gICAgICAgIGZlYXR1cmVUeXBlOiAnd2F0ZXInLFxyXG4gICAgICAgIHN0eWxlcnM6IFtcclxuICAgICAgICAgICAgeyBjb2xvcjogJyMxOWEwZDgnIH1cclxuICAgICAgICBdXHJcbiAgICB9LHtcclxuICAgICAgICBmZWF0dXJlVHlwZTogJ2FkbWluaXN0cmF0aXZlJyxcclxuICAgICAgICBlbGVtZW50VHlwZTogJ2xhYmVscy50ZXh0LnN0cm9rZScsXHJcbiAgICAgICAgc3R5bGVyczogW1xyXG4gICAgICAgICAgICB7IGNvbG9yOiAnI2ZmZmZmZicgfSxcclxuICAgICAgICAgICAgeyB3ZWlnaHQ6IDYgfVxyXG4gICAgICAgIF1cclxuICAgIH0se1xyXG4gICAgICAgIGZlYXR1cmVUeXBlOiAnYWRtaW5pc3RyYXRpdmUnLFxyXG4gICAgICAgIGVsZW1lbnRUeXBlOiAnbGFiZWxzLnRleHQuZmlsbCcsXHJcbiAgICAgICAgc3R5bGVyczogW1xyXG4gICAgICAgICAgICB7IGNvbG9yOiAnI2U4NTExMycgfVxyXG4gICAgICAgIF1cclxuICAgIH0se1xyXG4gICAgICAgIGZlYXR1cmVUeXBlOiAncm9hZC5oaWdod2F5JyxcclxuICAgICAgICBlbGVtZW50VHlwZTogJ2dlb21ldHJ5LnN0cm9rZScsXHJcbiAgICAgICAgc3R5bGVyczogW1xyXG4gICAgICAgICAgICB7IGNvbG9yOiAnI2VmZTllNCcgfSxcclxuICAgICAgICAgICAgeyBsaWdodG5lc3M6IC00MCB9XHJcbiAgICAgICAgXVxyXG4gICAgfSx7XHJcbiAgICAgICAgZmVhdHVyZVR5cGU6ICd0cmFuc2l0LnN0YXRpb24nLFxyXG4gICAgICAgIHN0eWxlcnM6IFtcclxuICAgICAgICAgICAgeyB3ZWlnaHQ6IDkgfSxcclxuICAgICAgICAgICAgeyBodWU6ICcjZTg1MTEzJyB9XHJcbiAgICAgICAgXVxyXG4gICAgfSx7XHJcbiAgICAgICAgZmVhdHVyZVR5cGU6ICdyb2FkLmhpZ2h3YXknLFxyXG4gICAgICAgIGVsZW1lbnRUeXBlOiAnbGFiZWxzLmljb24nLFxyXG4gICAgICAgIHN0eWxlcnM6IFtcclxuICAgICAgICAgICAgeyB2aXNpYmlsaXR5OiAnb2ZmJyB9XHJcbiAgICAgICAgXVxyXG4gICAgfSx7XHJcbiAgICAgICAgZmVhdHVyZVR5cGU6ICd3YXRlcicsXHJcbiAgICAgICAgZWxlbWVudFR5cGU6ICdsYWJlbHMudGV4dC5zdHJva2UnLFxyXG4gICAgICAgIHN0eWxlcnM6IFtcclxuICAgICAgICAgICAgeyBsaWdodG5lc3M6IDEwMCB9XHJcbiAgICAgICAgXVxyXG4gICAgfSx7XHJcbiAgICAgICAgZmVhdHVyZVR5cGU6ICd3YXRlcicsXHJcbiAgICAgICAgZWxlbWVudFR5cGU6ICdsYWJlbHMudGV4dC5maWxsJyxcclxuICAgICAgICBzdHlsZXJzOiBbXHJcbiAgICAgICAgICAgIHsgbGlnaHRuZXNzOiAtMTAwIH1cclxuICAgICAgICBdXHJcbiAgICB9LHtcclxuICAgICAgICBmZWF0dXJlVHlwZTogJ3BvaScsXHJcbiAgICAgICAgZWxlbWVudFR5cGU6ICdnZW9tZXRyeScsXHJcbiAgICAgICAgc3R5bGVyczogW1xyXG4gICAgICAgICAgICB7IHZpc2liaWxpdHk6ICdvbicgfSxcclxuICAgICAgICAgICAgeyBjb2xvcjogJyNmMGU0ZDMnIH1cclxuICAgICAgICBdXHJcbiAgICB9LHtcclxuICAgICAgICBmZWF0dXJlVHlwZTogJ3JvYWQuaGlnaHdheScsXHJcbiAgICAgICAgZWxlbWVudFR5cGU6ICdnZW9tZXRyeS5maWxsJyxcclxuICAgICAgICBzdHlsZXJzOiBbXHJcbiAgICAgICAgICAgIHsgY29sb3I6ICcjZWZlOWU0JyB9LFxyXG4gICAgICAgICAgICB7IGxpZ2h0bmVzczogLTI1IH1cclxuICAgICAgICBdXHJcbiAgICB9XHJcbl07XHJcblxyXG4vL2NhY2hlIGdvb2dsZSBtYXAgb2JqZWN0IGFzIGdsb2JhbCB2YXJpYWJsZVxyXG52YXIgbWFwID0gbnVsbDtcclxuLy8gY2FjaGUgbXkgZ29vZ2xlIG1hcCBhcGkga2V5XHJcbnZhciBNWV9BUElfS0VZID0gXCJBSXphU3lBeVd4dUxEaTVhSXhNR3FBVEE3NHVMeDRodVkxdUY0aGdcIjtcclxuXHJcbi8vY2FjaGUgaW5mb1dpbmRvdyBvYmplY3QgYXMgZ2xvYmFsIHZhcmlhYmxlXHJcbnZhciBpbmZvV2luZG93ID0gbnVsbDtcclxuXHJcbnZhciBJTklUX1pPT01fTlVNID0gMTE7XHJcbnZhciBERVRBSUxfWk9PTV9OVU0gPSAxNDtcclxuXHJcbi8vZ29vZ2xlIG1hcCBBUEkgY2FsbGJhY2sgZnVuY3Rpb25cclxuZnVuY3Rpb24gaW5pdE1hcCgpe1xyXG4gICAgbWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLWNhbnZhcycpLCB7XHJcbiAgICAgICAgem9vbTogSU5JVF9aT09NX05VTSxcclxuICAgICAgICBjZW50ZXI6IGNlbnRlci5sb2NhdGlvblxyXG4gICAgfSk7XHJcbiAgICBtYXAuc2V0T3B0aW9ucyh7c3R5bGVzOiBzdHlsZXN9KTtcclxuXHJcbiAgICAvL2luaXRpYWxpemUgbWFya2VycyBvbiB0aGUgbWFwXHJcbiAgICB2YXIgbWFya2VycyA9IFtdO1xyXG4gICAgZ2VvTG9jYXRpb25zLmZvckVhY2goZnVuY3Rpb24obG9jKXtcclxuICAgICAgICB2YXIgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiBsb2MubG9jYXRpb24sXHJcbiAgICAgICAgICAgIG1hcDogbWFwLFxyXG4gICAgICAgICAgICB0aXRsZTogbG9jLnRpdGxlLFxyXG4gICAgICAgICAgICBpY29uOiB7XHJcbiAgICAgICAgICAgICAgICB1cmw6IGxvYy5pY29uXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBtYXJrZXIuYWRkTGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vaGF2ZSB0aGUgIG1hcmtlciBib3VuY2UgZm9yIGEgbGltaXRlZCB0aW1lc1xyXG4gICAgICAgICAgICBtYXJrZXIuc2V0QW5pbWF0aW9uKDQpO1xyXG4gICAgICAgICAgICBvcGVuSW5mb1dpbmRvdyhtYXJrZXIpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIG1hcmtlcnMucHVzaChtYXJrZXIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy9pbnZva2UgZnVuY3Rpb24gdG8gYXBwbHkga25vY2tvdXQgYmluZGluZ3NcclxuICAgIGluaXRLb1ZpZXdNb2RlbDRBcHAobWFya2Vycyk7XHJcbn1cclxuXHJcbi8qXHJcbiogQGRlc2NyaXB0aW9uOiBvcGVuIGluZm8gd2luZG93IGZvclxyXG4qICAgICAgICAgICAgICB0aGUgZ2l2ZW4gZ29vZ2xlIG1hcCBtYXJrZXJcclxuKiBAcGFyYW0gIG1hcmtlciB0aGUgb2JqZWN0IG9mIG1hcmtlclxyXG4qIEByZXR1cm4gdm9pZFxyXG4qICovXHJcbmZ1bmN0aW9uIG9wZW5JbmZvV2luZG93KG1hcmtlcil7XHJcblxyXG4gICAgLy9jcmVhdGUgYW4gaW5mbyB3aW5kb3cgb2JqZWN0XHJcbiAgICAvL29yIHNldCBjb250ZW50IG9uIHRoZSBleGlzdGluZyBpbmZvIHdpbmRvd1xyXG4gICAgLy93ZSBuZWVkbid0IGNyZWF0ZSBpbmZvIHdpbmRvdyBvYmplY3QgcmVwZWF0ZWRseVxyXG4gICAgaWYoIWluZm9XaW5kb3cpe1xyXG4gICAgICAgIGluZm9XaW5kb3cgPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyh7XHJcbiAgICAgICAgICAgIHBvc2l0aW9uOiBtYXJrZXIuZ2V0UG9zaXRpb24oKSxcclxuICAgICAgICAgICAgbWF4V2lkdGg6IDM1MFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGluZm9XaW5kb3cuYWRkTGlzdGVuZXIoJ2Nsb3NlY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaW5mb1dpbmRvdy5tYXJrZXIgPSBudWxsO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfWVsc2V7XHJcbiAgICAgICAgaW5mb1dpbmRvdy5tYXJrZXIgPSBtYXJrZXI7XHJcbiAgICB9XHJcblxyXG4gICAgaW5mb1dpbmRvdy5zZXRDb250ZW50KFwiXCIpO1xyXG4gICAgaW5mb1dpbmRvdy5tYXJrZXIgPSBtYXJrZXI7XHJcbiAgICBzaG93TG9jYXRpb25EZXRhaWwobWFya2VyKTtcclxuICAgIGluZm9XaW5kb3cub3BlbihtYXAsIG1hcmtlcik7XHJcblxyXG59XHJcblxyXG5cclxuLypcclxuICogQGRlc2NyaXB0aW9uOiBxdWVyeSBkZXRhaWxlZCBpbmZvcm1hdGlvblxyXG4gKiBmb3IgdGhlIGdpdmVuIG1hcmtlciBhbmQgc2V0IGNvbnRlbnQgZm9yXHJcbiAqIGN1cnJlbnQgaW5mbyB3aW5kb3dcclxuICogQHBhcmFtICBtYXJrZXIgdGhlIG9iamVjdCBvZiBtYXJrZXJcclxuICogQHJldHVybiB2b2lkXHJcbiogKi9cclxuZnVuY3Rpb24gc2hvd0xvY2F0aW9uRGV0YWlsKG1hcmtlcil7XHJcblxyXG4gICAgdmFyIHVybCA9IFwiaHR0cHM6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL2dlb2NvZGUvanNvbj9sYXRsbmc9XCIgK1xyXG4gICAgICAgIG1hcmtlci5wb3NpdGlvbi5sYXQoKSArXHJcbiAgICAgICAgXCIsXCIgK1xyXG4gICAgICAgIG1hcmtlci5wb3NpdGlvbi5sbmcoKSArXHJcbiAgICAgICAgXCIma2V5PVwiICtcclxuICAgICAgICBNWV9BUElfS0VZO1xyXG5cclxuICAgIC8vbWFrZSBhamF4IHJlcXVlc3QgdG8gZm91cnNxdWFyZSBhcGlcclxuICAgICQuYWpheCh7XHJcbiAgICAgICAgdXJsIDogdXJsXHJcbiAgICAgICAgLy9kbyByZXNwb25zZSBzdWNjZXNzIGhhbmRsaW5nXHJcbiAgICB9KS5kb25lKGZ1bmN0aW9uKGRhdGEsIHRleHRTdGF0dXMsIGpxWGhyKXtcclxuICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgdmFyIGRldGFpbFN0cmluZyA9IFwiXCI7XHJcbiAgICAgICBpZihkYXRhLnN0YXR1cyA9PT0gXCJPS1wiKXtcclxuICAgICAgICAgICAgdmFyIHBsYWNlX2lkID0gZGF0YS5yZXN1bHRzWzBdLnBsYWNlX2lkO1xyXG4gICAgICAgICAgIGRldGFpbFN0cmluZyArPSBcIjxkaXY+5Zyw5Z2ASUQ6XCIgKyBwbGFjZV9pZCArIFwiPC9kaXY+XCI7XHJcblxyXG4gICAgICAgICAgIHZhciBmb3JtYXR0ZWRfYWRkcmVzcyA9IGRhdGEucmVzdWx0c1swXS5mb3JtYXR0ZWRfYWRkcmVzcztcclxuICAgICAgICAgICBkZXRhaWxTdHJpbmcgKz0gXCI8ZGl2PuivpuaDhTpcIiArIGZvcm1hdHRlZF9hZGRyZXNzICsgXCI8L2Rpdj5cIjtcclxuXHJcbiAgICAgICAgICAgdmFyIGdlb21ldHJ5ID0gZGF0YS5yZXN1bHRzWzBdLmdlb21ldHJ5O1xyXG4gICAgICAgICAgIGRldGFpbFN0cmluZyArPSBcIjxkaXY+57G75Z6LOlwiICsgZ2VvbWV0cnkubG9jYXRpb25fdHlwZSArIFwiPC9kaXY+XCI7XHJcbiAgICAgICAgICAgZGV0YWlsU3RyaW5nICs9IFwiPGRpdj7nuqzluqY6XCIgKyBnZW9tZXRyeS5sb2NhdGlvbi5sYXQgKyBcIjwvZGl2PlwiO1xyXG4gICAgICAgICAgIGRldGFpbFN0cmluZyArPSBcIjxkaXY+57uP5bqmOlwiICsgZ2VvbWV0cnkubG9jYXRpb24ubG5nICsgXCI8L2Rpdj5cIjtcclxuICAgICAgICAgICBpbmZvV2luZG93LnNldENvbnRlbnQoZGV0YWlsU3RyaW5nKTtcclxuICAgICAgIH1cclxuICAgICAgICAvL2RvIHJlc3BvbnNlIGVycm9yIGhhbmRsaW5nXHJcbiAgICB9KS5mYWlsKGZ1bmN0aW9uKGpxWGhyLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bil7XHJcbiAgICAgICAgY29uc29sZS5sb2coIFwidGV4dFN0YXR1czpcIiArIHRleHRTdGF0dXMgKyBcIiwgZXJyb3JUaHJvd246XCIgK2Vycm9yVGhyb3duKTtcclxuICAgICAgICAvL2RvIGFqYXggbG9nZ2luZyBvbiB0aGUgYnJvd3NlciBjb25zb2xlXHJcbiAgICB9KS5hbHdheXMgKGZ1bmN0aW9uKGpxWEhST3JEYXRhLCB0ZXh0U3RhdHVzLCBqcVhIUk9yRXJyb3JUaHJvd24pIHtcclxuICAgICAgICBjb25zb2xlLmxvZyggXCJhamF4IHJlcXVlc3QgdG8gZm91cnNxdWFyZSBpcyBjb21wbGV0ZWQsIHRleHRTdGF0dXM6XCIgKyB0ZXh0U3RhdHVzKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5cclxuLy9hZGQgZ2xvYmFsIGFycmF5IGZvciBjb2ZmZWUgc2hvcCBtYXJrZXJzXHJcbnZhciBjb2ZmZWVTaG9wTWFya2VycyA9IFtdO1xyXG5cclxuLypcclxuKiBAZGVzY3JpcHRpb246IGxvYWQgY29mZmVlIHNob3AgaW5mb3JtYXRpb25cclxuKiAgICAgICAgICAgICAgIGJ5IGZvdXJzcXVhcmUgYXBpXHJcbiogQHBhcmFtIG1hcmtlcjogdGhlIGNsaWNrZWQgbWFya2VyIG9iamVjdFxyXG4qIEByZXR1cm4gdm9pZFxyXG4qICovXHJcbmZ1bmN0aW9uIGxvYWRDb2ZmZWVTaG9wSW5mbyhtYXJrZXIpe1xyXG4gICAgLy9jbGVhciBvbGQgbWFya2Vyc1xyXG4gICAgY29mZmVlU2hvcE1hcmtlcnMuZm9yRWFjaChmdW5jdGlvbihjb2ZmZWVCYXJNYXJrZXIpe1xyXG4gICAgICAgIGNvZmZlZUJhck1hcmtlci5zZXRNYXAobnVsbCk7XHJcbiAgICB9KTtcclxuICAgIC8vZ3JhbnQgcGVybWlzc2lvbiBvZiByZWN5Y2xpbmcgdGhlIG9sZC1mYXNoaW9uZWQgb2JqZWN0cyB0byBqcyBlbmdpbmVcclxuICAgIGNvZmZlZVNob3BNYXJrZXJzLmxlbmd0aCA9IDA7XHJcblxyXG4gICAgLypcclxuICAgICogbmVpZ2hib3Job29kLW1hcFxyXG4gICAgIEFwcCBJbmZvcm1hdGlvblxyXG4gICAgKiAqL1xyXG4gICAgdmFyIGNsaWVudElkID0gJ1hCRVZSV00xSkdZT0IyV1M1TE1QTTM1QkpaRkFBTk9UQVBFRUdOTkhRNTJCRE9YVic7XHJcbiAgICB2YXIgY2xpZW50U2VjcmV0ID0gJ1AxWEJYVFNBR09LQVdNR1lJTUhPQUxHMU5TQlBPSllWWkxVQUQ1UlNRRUdKM01ONSc7XHJcblxyXG4gICAgLypcclxuICAgICogY29uY2F0ZW5hdGUgdGhlIHJlcXVlc3QgdXJsIHN0cmluZ1xyXG4gICAgKiAqL1xyXG4gICAgdmFyIGJhc2VVcmwgPSBcImh0dHBzOi8vYXBpLmZvdXJzcXVhcmUuY29tL3YyL3ZlbnVlcy9leHBsb3JlP1wiO1xyXG4gICAgdmFyIHF1ZXJ5UGFyYW1zID0gXCJsbD1cIisgbWFya2VyLnBvc2l0aW9uLmxhdCgpICtcIiUyQ1wiKyBtYXJrZXIucG9zaXRpb24ubG5nKCkgK1wiJnNlY3Rpb249Y29mZmVlJmxpbWl0PTEwJm5vdmVsdHk9bmV3XCI7XHJcbiAgICB2YXIgdXNlckluZm8gPSAnJmNsaWVudF9pZD0nICsgY2xpZW50SWQgKyAnJmNsaWVudF9zZWNyZXQ9JyArIGNsaWVudFNlY3JldCArIFwiJnY9MjAxNzAzMDhcIjtcclxuICAgIHZhciB1cmwgPSBiYXNlVXJsICsgcXVlcnlQYXJhbXMgKyB1c2VySW5mbztcclxuXHJcbiAgICAvL21ha2UgYWpheCByZXF1ZXN0IHRvIGZvdXJzcXVhcmUgYXBpXHJcbiAgICAkLmFqYXgoe1xyXG4gICAgICAgIHVybCA6IHVybFxyXG4gICAgLy9kbyByZXNwb25zZSBzdWNjZXNzIGhhbmRsaW5nXHJcbiAgICB9KS5kb25lKGZ1bmN0aW9uKGRhdGEsIHRleHRTdGF0dXMsIGpxWGhyKXtcclxuICAgICAgICAgICAgdmFyIGl0ZW1zID0gZGF0YS5yZXNwb25zZS5ncm91cHNbMF0uaXRlbXM7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gaXRlbXMpe1xyXG4gICAgICAgICAgICAgICAgdmFyIHZlbnVlID0gaXRlbXNbaV0udmVudWU7XHJcbiAgICAgICAgICAgICAgICAvLyBwbGFjZSB0aGUgYSBtYXJrZXIgb24gdGhlIG1hcFxyXG4gICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHZlbnVlLmxvY2F0aW9uLmxhdCx2ZW51ZS5sb2NhdGlvbi5sbmcpLFxyXG4gICAgICAgICAgICAgICAgICAgIG1hcDogbWFwLFxyXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiB2ZW51ZS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIGljb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi4vZGlzdC9pbWFnZXMvY29mZmVlLW4tdGVhLnBuZ1wiXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBjb2ZmZWVTaG9wTWFya2Vycy5wdXNoKG1hcmtlcik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAvL2RvIHJlc3BvbnNlIGVycm9yIGhhbmRsaW5nXHJcbiAgICB9KS5mYWlsKGZ1bmN0aW9uKGpxWGhyLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bil7XHJcbiAgICAgICAgY29uc29sZS5sb2coIFwidGV4dFN0YXR1czpcIiArIHRleHRTdGF0dXMgKyBcIiwgZXJyb3JUaHJvd246XCIgK2Vycm9yVGhyb3duKTtcclxuICAgIC8vZG8gYWpheCBsb2dnaW5nIG9uIHRoZSBicm93c2VyIGNvbnNvbGVcclxuICAgIH0pLmFsd2F5cyAoZnVuY3Rpb24oanFYSFJPckRhdGEsIHRleHRTdGF0dXMsIGpxWEhST3JFcnJvclRocm93bikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCBcImFqYXggcmVxdWVzdCB0byBmb3Vyc3F1YXJlIGlzIGNvbXBsZXRlZCwgdGV4dFN0YXR1czpcIiArIHRleHRTdGF0dXMpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8qXHJcbiogQGRlc2NyaXB0aW9uOiB6b29tIGluIGFuZCBzZXQgY2VudGVyIG9mIHRoZSBtYXBcclxuKiBAcGFyYW0gbWFya2VyIHRoZSBnaXZlbiBtYXJrZXJcclxuKiBAcmV0dXJuIHZvaWRcclxuKiAqL1xyXG5mdW5jdGlvbiB6b29tSW4yTWFya2VyKG1hcmtlcil7XHJcbiAgICBtYXAuc2V0Q2VudGVyKG1hcmtlci5nZXRQb3NpdGlvbigpKTtcclxuICAgIG1hcC5zZXRab29tKERFVEFJTF9aT09NX05VTSk7XHJcbn1cclxuXHJcbi8qXHJcbiAqIEBkZXNjcmlwdGlvbjogem9vbSBvdXQgdG8gdGhlIGluaXRpYWwgc3RhdGUgb2YgZ29vZ2xlIG1hcFxyXG4gKiBAcGFyYW0gbm9uZVxyXG4gKiBAcmV0dXJuIHZvaWRcclxuICogKi9cclxuZnVuY3Rpb24gem9vbU91dDJJbml0U3RhdHVzKCl7XHJcbiAgICBtYXAuc2V0Q2VudGVyKGNlbnRlci5sb2NhdGlvbik7XHJcbiAgICBtYXAuc2V0Wm9vbShJTklUX1pPT01fTlVNKTtcclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcbiJdfQ==
